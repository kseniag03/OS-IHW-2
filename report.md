#  ИДЗ №2 #
## Markdown report <br> ##

### 1. Ганина Ксения Андреевна 212 (тг для вопросов: @kgnn47) <br> ###
### 2. Вариант-21 <br> ###

![image](https://user-images.githubusercontent.com/114473740/233373017-42e56507-db24-47fd-a033-ff46b3e36a59.png)
![image](https://user-images.githubusercontent.com/114473740/232320682-3f8504cb-5b03-4b67-869a-c32d4fa825c1.png)
![image](https://user-images.githubusercontent.com/114473740/232320698-cfeb096e-79c6-46d7-9731-20ce879d40da.png)
________________________

### 3. Содержание отчёта и нюансы <br> ###

Каждый следующий раздел содержит сценарий решаемой задачи, нюансы к коду и ссылку на соответствующий код <br>
Разделы 4-6: 1 родитель-супервизор запускает 3 детей-программистов <br>
Разделы 7-8: 3 независимых процесса-программиста <br>

В командной строке можно записать число задач для выполнения. Число 1 не подходит, т.к. по условию должен происходить обмен между программистами. Также аргумент не может превышать определённую константу, чтобы правильно инициализировать массив задач. Константы в коде можно менять в блоке с define.

псевдокод программиста (у всех задачи одинаковые): <br>
```cpp
while 1
	get task from pull of tasks (from buffer in shared memory)
	if task_buffer is empty: break
	startProgram() - working on its task
	when finishes -- finishProgram (task = -3 -> -2)
	when gets other program for check -- getForCheck (task = -2 -> -1)
	when gets its program after checking -- getChecked and isCorrect = 0 or 1 (task = -1 -> 0|1)

	// isCorrect = rand() % 2
```

Получение текущего индекса внутри процесса идёт поочерёдно (проход после первого просочившегося закрывается семафором), выбирается следующая нетронутая задача.

Также используются два семафора, которые предотвращают одновременное обращение к общим ресурсам -- к pid-м проверяющего процесса и исправляющего соот-но

Тестовые прогоны (скриншоты) прикреплены в соот-х папках (ссылки будут ниже, в нужных разделах)

________________________

### 4. именованные POSIX семафоры <br> ###

#### 4.1. Сценарий задачи <br> ####

Программисты выполняют по 3 задачи, рядом идёт этап проверки

pi, pj, pk -- дочерние процессы, родительский процесс играет роль тимлида-супервизора, который запускает работу программистов

Этап выполнения:

    // pi берёт task[cur + 0], pj -- task[cur + 1], pk -- task[cur + 2]
    // время выполнения = rand % MAX_TASK_COUNT
    // по условию если один программист получил корректный вердикт своей задачи, то он берет следующую задачу
    // т.е. с каждой завершённой задачей увеличивается индекс cur
    // нужно увеличивать cur после получения верной задачи
    // и здесь использовать семафор, чтобы не было обращения к одному ресурсу от нескольких программистов

Этап проверки:

    // pi -- первый закончивший задачу, pj -- второй закончивший задачу
    // pk либо передаёт задачу pj, если pi исправляет свою задачу,
    //    либо передаёт задачу pi, если pj проверяет задачу

    // pi блокируется, когда ждёт результата проверки от pj, используя sem_wait
    // pj передаёт в shared-object результат проверки и использует sem_post, чтобы уведомить об окончании проверки

    // если pi получает 0, он какое-то время исправляет задачу (спит), передаёт обратно
    // повторить while pi не получит 1

    // pi сначала проверяет программу от pk, а потом получает результат и делает исправления

    // переход к следующей задаче

// while cur != count (MAX_TASK_COUNT default)

#### 4.2. Код с комментариями <br> ####

// WANTED

[Задание на 4 балла](https://github.com/kseniag03/OS-IHW-2/tree/master/4) <br>
[Код на 4 балла](https://github.com/kseniag03/OS-IHW-2/blob/master/4/4.c) <br>
________________________

### 5. неименованные POSIX семафоры <br> ###

#### 5.1. Сценарий задачи <br> ####

Взаимодействия аналогичны 4.1. Меняются только инструменты (семафоры)

Т.к. процессы родственные, то можно использовать неименованные семафоры благодаря ссылкам

#### 5.2. Код с комментариями <br> ####

[Задание на 5 баллов](https://github.com/kseniag03/OS-IHW-2/tree/master/5) <br>
[Код на 5 баллов](https://github.com/kseniag03/OS-IHW-2/tree/master/5/5.c) <br>
________________________

### 6. семафоры в стандарте UNIX SYSTEM V <br> ###

#### 6.1. Сценарий задачи <br> ####

Взаимодействия аналогичны 4.1. Меняются только инструменты (семафоры и разделяемая память)

#### 6.2. Код с комментариями <br> ####

// WANTED

[Задание на 6 баллов](https://github.com/kseniag03/OS-IHW-2/tree/master/6) <br>
[Код на 6 баллов](https://github.com/kseniag03/OS-IHW-2/tree/master/6/6.c) <br>
________________________

### 7. стандарт POSIX <br> ###

#### 7.1. Сценарий задачи <br> ####

Аналогичный п. 4.1., только вместо дочерних процессов три независимых. Общие функции и структуры выделены в отдельный файл

#### 7.2. Код с комментариями <br> ####

// WANTED

[Задание на 7 баллов](https://github.com/kseniag03/OS-IHW-2/tree/master/7) <br>
[Код на 7 баллов, 1й процесс](https://github.com/kseniag03/OS-IHW-2/tree/master/7/7-1.c) <br>
[Код на 7 баллов, 2й процесс](https://github.com/kseniag03/OS-IHW-2/tree/master/7/7-2.c) <br>
________________________

### 8. стандарт UNIX SYSTEM V <br> ###

#### 8.1. Сценарий задачи <br> ####

// WANTED

#### 8.2. Код с комментариями <br> ####

// WANTED

[Задание на 8 баллов](https://github.com/kseniag03/OS-IHW-2/tree/master/8) <br>
[Код на 8 баллов, 1й процесс](https://github.com/kseniag03/OS-IHW-2/tree/master/8/8-1.c) <br>
[Код на 8 баллов, 2й процесс](https://github.com/kseniag03/OS-IHW-2/tree/master/8/8-2.c) <br>

